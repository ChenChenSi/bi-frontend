# BI æŠ¥è¡¨ç³»ç»Ÿ (BI Reporting System)

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº **Vue 2.x** + **Quasar 1.x** + **ECharts 5.x** çš„ä¼ä¸šçº§ BI æŠ¥è¡¨ç³»ç»Ÿã€‚è¯¥ç³»ç»Ÿæ—¨åœ¨æä¾›çµæ´»çš„æŠ¥è¡¨è®¾è®¡èƒ½åŠ›ã€é«˜æ€§èƒ½çš„å®æ—¶æ•°æ®å±•ç¤ºä»¥åŠç²¾ç»†åŒ–çš„æƒé™ç®¡ç†ï¼Œæ”¯æŒå¤šå›¢é˜Ÿåä½œï¼ˆå·¥ä½œåŒºæ¨¡å¼ï¼‰ã€‚

æ ¸å¿ƒç›®æ ‡æ˜¯è®©ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡ç®€å•çš„æ‹–æ‹½é…ç½®ç”Ÿæˆå¯è§†åŒ–çš„æ•°æ®å¤§å±ï¼Œå¹¶æ”¯æŒå®æ—¶ç›‘æ§å’Œäº¤äº’åˆ†æï¼ˆä¸‹é’»ã€è”åŠ¨ï¼‰ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **å‰ç«¯æ¡†æ¶**: Vue 2.x
- **UI ç»„ä»¶åº“**: Quasar Framework 1.x (Material Design)
- **å›¾è¡¨åº“**: ECharts 5.x
- **HTTP è¯·æ±‚**: Axios (å°è£…æ‹¦æˆªå™¨å®ç°è‡ªåŠ¨é‡è¯•ä¸é”™è¯¯å¤„ç†)
- **çŠ¶æ€ç®¡ç†**: Vuex
- **è·¯ç”±**: Vue Router
- **æ„å»ºå·¥å…·**: Webpack (Quasar CLI)
- **Mock æ•°æ®**: Mock.js (å¼€å‘é˜¶æ®µå…¨æ¥å£ Mock)

## ğŸ— ç³»ç»Ÿæ¶æ„å›¾

```mermaid
graph TD
    User[ç”¨æˆ· / æµè§ˆå™¨] --> |HTTP/HTTPS| WebApp[BI å‰ç«¯åº”ç”¨]
    
    subgraph "å‰ç«¯æ ¸å¿ƒæ¨¡å— (Frontend Core)"
        WebApp --> Router[è·¯ç”±ç®¡ç†]
        WebApp --> Store[Vuex çŠ¶æ€ç®¡ç†]
        
        subgraph "ä¸šåŠ¡æ¨¡å—"
            Workspace[å·¥ä½œåŒºç®¡ç†]
            Designer[æŠ¥è¡¨è®¾è®¡å™¨]
            Viewer[æŠ¥è¡¨æµè§ˆ]
            Auth[è®¤è¯ä¸æƒé™]
        end
        
        subgraph "é€šç”¨æœåŠ¡"
            Request[Axios å°è£…]
            Polling[å®æ—¶è½®è¯¢æœåŠ¡]
            ErrorHandler[å®¹é”™ä¸é‡è¯•]
        end
        
        Designer --> |æ‹–æ‹½/é…ç½®| Canvas[ç”»å¸ƒç»„ä»¶]
        Viewer --> |æ¸²æŸ“| Canvas
        Viewer --> |ä¸‹é’»/è”åŠ¨| DrillDown[äº¤äº’åˆ†æ]
        
        Canvas --> |æ¸²æŸ“| ECharts[ECharts å®ä¾‹]
    end
    
    subgraph "åç«¯æœåŠ¡ (Backend / Mock)"
        API_Auth[è®¤è¯æ¥å£]
        API_Report[æŠ¥è¡¨é…ç½®æ¥å£]
        API_Data[æ•°æ®æŸ¥è¯¢æ¥å£]
        API_Alert[å‘Šè­¦æ¥å£]
    end
    
    Request --> |Token| API_Auth
    Request --> |CRUD| API_Report
    Request --> |Query| API_Data
    ErrorHandler --> |Retry 3æ¬¡| API_Data
    ErrorHandler --> |Report Failure| API_Alert
```

## ğŸ§© æ¨¡å—æ¦‚è§ˆ

ç³»ç»Ÿä¸»è¦åˆ†ä¸ºä»¥ä¸‹äº”ä¸ªæ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œè¯¦ç»†è®¾è®¡æ–‡æ¡£è¯·å‚è€ƒ `design/` ç›®å½•ï¼š

### 1. [å·¥ä½œåŒºç®¡ç† (Workspace)](design/workspace/requirements.md)
- **å®šä½**: å¤šå›¢é˜Ÿåä½œçš„é¡¶å±‚å®¹å™¨ã€‚
- **åŠŸèƒ½**: åˆ›å»ºå·¥ä½œåŒºã€ç®¡ç†æˆå‘˜ã€åˆ†é…è§’è‰²ï¼ˆè¶…ç®¡ã€è®¿å®¢ç­‰ï¼‰ã€ç”¨æˆ·ç»„ç®¡ç†ã€‚
- **API**: `/workspaces`

### 2. [æŠ¥è¡¨è®¾è®¡å™¨ (Report Designer)](design/report_designer/requirements.md)
- **å®šä½**: æ ¸å¿ƒç”Ÿäº§å·¥å…·ã€‚
- **åŠŸèƒ½**: 
  - ç”»å¸ƒè‡ªç”±å¸ƒå±€/æ …æ ¼å¸ƒå±€ã€‚
  - å›¾è¡¨ç»„ä»¶æ‹–æ‹½ä¸é…ç½®ï¼ˆå¤§å°ã€æ ·å¼ã€æ•°æ®æºï¼‰ã€‚
  - **è‡ªé€‚åº”ç¼©æ”¾**: åŸºäº CSS `transform: scale` çš„é«˜æ€§èƒ½ç¼©æ”¾æ–¹æ¡ˆã€‚
- **API**: `/reports` (CRUD)

### 3. [æŠ¥è¡¨æµè§ˆ (Report Viewer)](design/report_viewer/requirements.md)
- **å®šä½**: æ•°æ®æ¶ˆè´¹ç«¯ã€‚
- **åŠŸèƒ½**:
  - **é«˜æ€§èƒ½åŠ è½½**: éª¨æ¶å±ä¼˜å…ˆ + ç»„ä»¶ç‹¬ç«‹å¹¶å‘è¯·æ±‚ã€‚
  - **å®æ—¶æ€§**: å®šæ—¶è½®è¯¢åç«¯çŠ¶æ€ï¼Œæ”¯æŒå¢é‡åˆ·æ–°ã€‚
  - **äº¤äº’**: å…¨å±€è¿‡æ»¤ã€å›¾è¡¨ç‚¹å‡»ä¸‹é’» (Drill-down)ã€‚
- **API**: `/reports/{id}/layout`, `/data/query`

### 4. [è®¤è¯ä¸æƒé™ (Auth & RBAC)](design/auth_rbac/requirements.md)
- **å®šä½**: å®‰å…¨åŸºçŸ³ã€‚
- **åŠŸèƒ½**:
  - ç”¨æˆ·ç™»å½•ä¸ Token ç®¡ç†ã€‚
  - **RBAC**: å·¥ä½œåŒºç®¡ç†å‘˜ã€æŠ¥å‘Šç®¡ç†å‘˜ã€ç¼–è¾‘è€…ã€è®¿å®¢å››çº§è§’è‰²ã€‚
  - **æƒé™ç”³è¯·**: æ— æƒè®¿é—®æ—¶è§¦å‘ç”³è¯·æµç¨‹ï¼Œé€šçŸ¥ç®¡ç†å‘˜å®¡æ‰¹ã€‚
- **API**: `/auth/login`, `/access-request`

### 5. [å®¹é”™ä¸å‘Šè­¦ (Fault Tolerance)](design/fault_tolerance/requirements.md)
- **å®šä½**: ç¨³å®šæ€§ä¿éšœã€‚
- **åŠŸèƒ½**:
  - **è‡ªåŠ¨é‡è¯•**: æ¥å£å¤±è´¥è‡ªåŠ¨é‡è¯• 3 æ¬¡ï¼ˆé—´éš” 5sï¼‰ã€‚
  - **å¤±è´¥å…œåº•**: é‡è¯•è€—å°½åæ˜¾ç¤ºå‹å¥½æç¤ºã€‚
  - **å¼‚å¸¸ä¸ŠæŠ¥**: è‡ªåŠ¨è°ƒç”¨æ¥å£é€šçŸ¥æŠ¥å‘Šç®¡ç†å‘˜ã€‚

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ api/                # API æ¥å£å®šä¹‰ (æŒ‰æ¨¡å—æ‹†åˆ†)
â”œâ”€â”€ assets/             # é™æ€èµ„æº
â”œâ”€â”€ components/         # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ charts/         # ECharts å°è£… (BaseChart.vue)
â”‚   â”œâ”€â”€ designer/       # è®¾è®¡å™¨ä¸“ç”¨ç»„ä»¶ (Canvas, ConfigPanel)
â”‚   â””â”€â”€ common/         # é€šç”¨ UI (Loading, ErrorState)
â”œâ”€â”€ layouts/            # é¡µé¢å¸ƒå±€ (MainLayout, AuthLayout)
â”œâ”€â”€ mock/               # Mock æ•°æ® (æ¨¡æ‹Ÿåç«¯æ¥å£)
â”œâ”€â”€ pages/              # é¡µé¢è§†å›¾
â”‚   â”œâ”€â”€ workspace/      # å·¥ä½œåŒºåˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ designer/       # æŠ¥è¡¨è®¾è®¡é¡µ
â”‚   â””â”€â”€ viewer/         # æŠ¥è¡¨æµè§ˆé¡µ
â”œâ”€â”€ router/             # è·¯ç”±é…ç½®
â”œâ”€â”€ store/              # Vuex çŠ¶æ€ç®¡ç†
â”œâ”€â”€ utils/              # å·¥å…·å‡½æ•° (request.js æ‹¦æˆªå™¨ç­‰)
â””â”€â”€ App.vue
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Node.js >= 12
- Yarn / NPM

### å®‰è£…ä¾èµ–
```bash
npm install
```

### å¯åŠ¨å¼€å‘ç¯å¢ƒ
```bash
npm run dev
# å°†è‡ªåŠ¨å¯åŠ¨ Mock æœåŠ¡
```

### æ„å»ºç”Ÿäº§ç¯å¢ƒ
```bash
npm run build
```
