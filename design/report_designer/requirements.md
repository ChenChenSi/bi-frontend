# 报表设计 (Report Designer) 需求文档

## 1. 概述
报表设计器是核心模块，允许用户通过拖拽和配置图表组件，构建个性化的 BI 报表。

**相关文档**:
- [技术方案与最佳实践 (Technical Design)](technical_design.md): 包含 `vue-grid-layout` 与 `vuedraggable` 的具体实现细节。

## 2. 功能需求

### 2.1 画布布局 (Canvas & Layout)
- **网格吸附布局 (Grid Layout)**: 
  - 核心交互模式。组件在拖拽移动或缩放时，应自动吸附到最近的网格线上，确保报表整洁对齐。
  - 支持 **自动防碰撞** (Auto Collision): 拖动组件时，其他组件应自动避让或挤开。
- **物料拖拽**:
  - 左侧提供组件物料区，用户可将图表组件直接拖入画布。
- **画布设置**:
  - 用户可自定义画布尺寸 (如 1920x1080) 或选择预设分辨率。
  - 背景颜色/图片设置。
- **自适应缩放**:
  - 核心要求：画布容器在浏览时应随浏览器窗口大小缩放。
  - 实现方案：仅在 UI 层面使用 CSS `transform: scale()` 进行整体缩放，**禁止触发组件的数据重绘**（避免重复请求后端）。

### 2.2 图表组件库 (Widget Library)
- **基础图表**: 支持 ECharts 5.x 的常用图表：
  - 柱状图 (Bar)
  - 折线图 (Line)
  - 饼图 (Pie)
  - 其他（散点图、雷达图等可选）
- **通用配置**:
  - **大小与位置**: x, y, width, height (Grid Units)。
  - **样式**: 标题、边框、背景色、字体颜色、图例位置。
  - **数据绑定**: 选择数据源表、配置维度 (Dimension/X轴)、指标 (Metrics/Y轴)。
  - **过滤条件**: 组件级过滤（如：只展示“华北”地区数据）。

### 2.3 交互与保存
- **实时预览**: 编辑时所见即所得。
- **保存配置**: 将当前的布局、每个组件的配置保存为 JSON 结构到后端。
- **版本管理**: 每次保存生成新的版本号（可选）。
